=== RUN   TestNewAggregator
--- PASS: TestNewAggregator (0.00s)
=== RUN   TestProcessReportHostOnly
--- PASS: TestProcessReportHostOnly (0.00s)
=== RUN   TestProcessReportWithContainers
--- PASS: TestProcessReportWithContainers (0.00s)
=== RUN   TestProcessReportWithProcesses
--- PASS: TestProcessReportWithProcesses (0.00s)
=== RUN   TestProcessReportWithNetworkConnections
--- PASS: TestProcessReportWithNetworkConnections (0.00s)
=== RUN   TestGetNodesByType
--- PASS: TestGetNodesByType (0.00s)
=== RUN   TestGetNodeByID
--- PASS: TestGetNodeByID (0.00s)
=== RUN   TestCleanStaleNodes
--- PASS: TestCleanStaleNodes (0.00s)
=== RUN   TestAggregatorGetStats
--- PASS: TestAggregatorGetStats (0.00s)
=== RUN   TestExtractContainerIDFromCgroup
=== RUN   TestExtractContainerIDFromCgroup/Docker_cgroup_with_full_ID
=== RUN   TestExtractContainerIDFromCgroup/Docker_cgroup_with_prefix
=== RUN   TestExtractContainerIDFromCgroup/No_docker_in_cgroup
=== RUN   TestExtractContainerIDFromCgroup/Empty_cgroup
--- PASS: TestExtractContainerIDFromCgroup (0.00s)
    --- PASS: TestExtractContainerIDFromCgroup/Docker_cgroup_with_full_ID (0.00s)
    --- PASS: TestExtractContainerIDFromCgroup/Docker_cgroup_with_prefix (0.00s)
    --- PASS: TestExtractContainerIDFromCgroup/No_docker_in_cgroup (0.00s)
    --- PASS: TestExtractContainerIDFromCgroup/Empty_cgroup (0.00s)
=== RUN   TestTopologyConcurrency
--- PASS: TestTopologyConcurrency (0.00s)
=== RUN   TestApp_NewApp
=== RUN   TestApp_NewApp/ValidApp
=== RUN   TestApp_NewApp/EmptyID
=== RUN   TestApp_NewApp/ZeroPort
--- PASS: TestApp_NewApp (0.00s)
    --- PASS: TestApp_NewApp/ValidApp (0.00s)
    --- PASS: TestApp_NewApp/EmptyID (0.00s)
    --- PASS: TestApp_NewApp/ZeroPort (0.00s)
=== RUN   TestApp_Start
2025/10/17 23:14:48 Starting monitoring app test-app on port 0
--- PASS: TestApp_Start (0.10s)
=== RUN   TestApp_handleReport
=== RUN   TestApp_handleReport/ValidReport
2025/10/17 23:14:48 Received report from probe agent-1 with 1 containers
=== RUN   TestApp_handleReport/InvalidJSON
--- PASS: TestApp_handleReport (0.00s)
    --- PASS: TestApp_handleReport/ValidReport (0.00s)
    --- PASS: TestApp_handleReport/InvalidJSON (0.00s)
=== RUN   TestApp_handleGetTopology
=== RUN   TestApp_handleGetTopology/DefaultView
=== RUN   TestApp_handleGetTopology/ContainersView
=== RUN   TestApp_handleGetTopology/ProcessesView
--- PASS: TestApp_handleGetTopology (0.00s)
    --- PASS: TestApp_handleGetTopology/DefaultView (0.00s)
    --- PASS: TestApp_handleGetTopology/ContainersView (0.00s)
    --- PASS: TestApp_handleGetTopology/ProcessesView (0.00s)
=== RUN   TestApp_handleWebSocket
2025/10/17 23:14:48 New WebSocket connection from 127.0.0.1:49878
--- PASS: TestApp_handleWebSocket (0.00s)
=== RUN   TestApp_handleListContainers
--- PASS: TestApp_handleListContainers (0.00s)
=== RUN   TestApp_handleContainerStop
2025/10/17 23:14:48 Stopping container test-container
--- PASS: TestApp_handleContainerStop (0.00s)
=== RUN   TestApp_handleContainerStart
2025/10/17 23:14:48 Starting container test-container
--- PASS: TestApp_handleContainerStart (0.00s)
=== RUN   TestApp_handleContainerRestart
2025/10/17 23:14:48 Restarting container test-container
--- PASS: TestApp_handleContainerRestart (0.00s)
=== RUN   TestApp_handleContainerLogs
2025/10/17 23:14:48 Streaming logs for container test-container
--- PASS: TestApp_handleContainerLogs (0.00s)
=== RUN   TestApp_handleContainerExec
=== RUN   TestApp_handleContainerExec/ValidCommand
2025/10/17 23:14:48 Executing command in container test-container: [ls -la]
=== RUN   TestApp_handleContainerExec/InvalidJSON
--- PASS: TestApp_handleContainerExec (0.00s)
    --- PASS: TestApp_handleContainerExec/ValidCommand (0.00s)
    --- PASS: TestApp_handleContainerExec/InvalidJSON (0.00s)
=== RUN   TestApp_handleSearch
=== RUN   TestApp_handleSearch/ValidQuery
2025/10/17 23:14:48 Search query: nginx
=== RUN   TestApp_handleSearch/EmptyQuery
=== RUN   TestApp_handleSearch/NoQueryParam
--- PASS: TestApp_handleSearch (0.00s)
    --- PASS: TestApp_handleSearch/ValidQuery (0.00s)
    --- PASS: TestApp_handleSearch/EmptyQuery (0.00s)
    --- PASS: TestApp_handleSearch/NoQueryParam (0.00s)
=== RUN   TestApp_handleHealth
--- PASS: TestApp_handleHealth (0.00s)
=== RUN   TestApp_handleMetrics
--- PASS: TestApp_handleMetrics (0.00s)
=== RUN   TestApp_aggregateTopology
--- PASS: TestApp_aggregateTopology (0.05s)
=== RUN   TestApp_updateTopology
--- PASS: TestApp_updateTopology (0.00s)
=== RUN   TestApp_broadcastUpdates
--- PASS: TestApp_broadcastUpdates (0.05s)
=== RUN   TestApp_broadcastTopology
--- PASS: TestApp_broadcastTopology (0.00s)
=== RUN   TestApp_buildTopologyView
=== RUN   TestApp_buildTopologyView/ContainersView
=== RUN   TestApp_buildTopologyView/ProcessesView
=== RUN   TestApp_buildTopologyView/HostsView
=== RUN   TestApp_buildTopologyView/PodsView
=== RUN   TestApp_buildTopologyView/ServicesView
--- PASS: TestApp_buildTopologyView (0.00s)
    --- PASS: TestApp_buildTopologyView/ContainersView (0.00s)
    --- PASS: TestApp_buildTopologyView/ProcessesView (0.00s)
    --- PASS: TestApp_buildTopologyView/HostsView (0.00s)
    --- PASS: TestApp_buildTopologyView/PodsView (0.00s)
    --- PASS: TestApp_buildTopologyView/ServicesView (0.00s)
=== RUN   TestApp_EdgeCases
=== RUN   TestApp_EdgeCases/NilReport
2025/10/17 23:14:48 Received report from probe  with 0 containers
=== RUN   TestApp_EdgeCases/EmptyReports
=== RUN   TestApp_EdgeCases/EmptyTopology
--- PASS: TestApp_EdgeCases (0.00s)
    --- PASS: TestApp_EdgeCases/NilReport (0.00s)
    --- PASS: TestApp_EdgeCases/EmptyReports (0.00s)
    --- PASS: TestApp_EdgeCases/EmptyTopology (0.00s)
=== RUN   TestApp_ConcurrentAccess
2025/10/17 23:14:48 Received report from probe agent-9 with 0 containers
2025/10/17 23:14:48 Received report from probe agent-7 with 0 containers
2025/10/17 23:14:48 Received report from probe agent-1 with 0 containers
2025/10/17 23:14:48 Received report from probe agent-0 with 0 containers
2025/10/17 23:14:48 Received report from probe agent-3 with 0 containers
2025/10/17 23:14:48 Received report from probe agent-6 with 0 containers
2025/10/17 23:14:48 Received report from probe agent-2 with 0 containers
2025/10/17 23:14:48 Received report from probe agent-5 with 0 containers
2025/10/17 23:14:48 Received report from probe agent-8 with 0 containers
2025/10/17 23:14:48 Received report from probe agent-4 with 0 containers
--- PASS: TestApp_ConcurrentAccess (0.00s)
=== RUN   TestApp_WebSocketConcurrentAccess
--- PASS: TestApp_WebSocketConcurrentAccess (0.00s)
=== RUN   TestAppIntegration
2025/10/17 23:14:48 Starting app server on localhost:8080
2025/10/17 23:14:48 App server started successfully
2025/10/17 23:14:48 REST API: http://localhost:8080/api/v1
2025/10/17 23:14:48 WebSocket: ws://localhost:8080/api/v1/ws
2025/10/17 23:14:48 Health check: http://localhost:8080/health
2025/10/17 23:14:48 HTTP server error: listen tcp 127.0.0.1:8080: bind: address already in use
2025/10/17 23:14:48 Agent registered: agent-1 (hostname: host-agent-1)
[GIN] 2025/10/17 - 23:14:48 | 201 |     257.599µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:48 Agent registered: agent-2 (hostname: host-agent-2)
[GIN] 2025/10/17 - 23:14:48 | 201 |      21.076µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:48 Agent registered: agent-3 (hostname: host-agent-3)
[GIN] 2025/10/17 - 23:14:48 | 201 |      13.377µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:48 Report received from agent: agent-1 (hostname: host-agent-1)
[GIN] 2025/10/17 - 23:14:48 | 202 |     147.931µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:48 Report received from agent: agent-2 (hostname: host-agent-2)
[GIN] 2025/10/17 - 23:14:48 | 202 |      72.502µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:48 Report received from agent: agent-3 (hostname: host-agent-3)
[GIN] 2025/10/17 - 23:14:48 | 202 |      73.638µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:48 | 200 |      74.152µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:48 | 200 |      95.036µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:48 | 200 |       14.42µs |                 | GET      "/api/v1/query/agents/agent-1/latest"
[GIN] 2025/10/17 - 23:14:48 | 200 |      28.427µs |                 | GET      "/api/v1/query/agents/agent-1/timeseries?duration=1h"
[GIN] 2025/10/17 - 23:14:48 | 200 |      14.563µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:48 | 200 |       4.843µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:48 | 200 |       4.468µs |                 | GET      "/api/v1/ping"
[GIN] 2025/10/17 - 23:14:48 | 200 |       3.745µs |                 | POST     "/api/v1/agents/heartbeat/agent-1"
2025/10/17 23:14:48 Config requested for agent: agent-1
[GIN] 2025/10/17 - 23:14:48 | 200 |       6.362µs |                 | GET      "/api/v1/agents/config/agent-1"
2025/10/17 23:14:48 Stopping app server...
2025/10/17 23:14:48 App server stopped successfully
    app_test.go:250: Integration test completed successfully!
--- PASS: TestAppIntegration (0.10s)
=== RUN   TestAppEndToEnd
2025/10/17 23:14:48 Starting app server on localhost:8081
2025/10/17 23:14:48 App server started successfully
2025/10/17 23:14:48 REST API: http://localhost:8081/api/v1
2025/10/17 23:14:48 WebSocket: ws://localhost:8081/api/v1/ws
2025/10/17 23:14:48 Health check: http://localhost:8081/health
2025/10/17 23:14:48 Agent registered: e2e-agent-1 (hostname: e2e-host-1)
[GIN] 2025/10/17 - 23:14:48 | 201 |      22.629µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:48 Report received from agent: e2e-agent-1 (hostname: e2e-host-1)
[GIN] 2025/10/17 - 23:14:48 | 202 |       32.29µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:48 Report received from agent: e2e-agent-1 (hostname: e2e-host-1)
[GIN] 2025/10/17 - 23:14:48 | 202 |     138.738µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: e2e-agent-1 (hostname: e2e-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |      74.609µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 200 |     132.906µs |                 | GET      "/api/v1/query/agents/e2e-agent-1/timeseries?duration=1m"
[GIN] 2025/10/17 - 23:14:49 | 200 |      44.081µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:49 | 200 |       9.559µs |                 | GET      "/api/v1/query/agents/e2e-agent-1/latest"
    app_test.go:376: End-to-end test completed successfully!
2025/10/17 23:14:49 Stopping app server...
2025/10/17 23:14:49 App server stopped successfully
--- PASS: TestAppEndToEnd (0.30s)
=== RUN   TestAppResilience
=== RUN   TestAppResilience/InvalidReport
[GIN] 2025/10/17 - 23:14:49 | 400 |      48.862µs |                 | POST     "/api/v1/reports"
=== RUN   TestAppResilience/NonExistentAgent
[GIN] 2025/10/17 - 23:14:49 | 404 |       3.741µs |                 | GET      "/api/v1/query/agents/non-existent/latest"
=== RUN   TestAppResilience/InvalidDuration
[GIN] 2025/10/17 - 23:14:49 | 400 |      28.092µs |                 | GET      "/api/v1/query/agents/test-agent/timeseries?duration=invalid"
=== RUN   TestAppResilience/InvalidRegistration
[GIN] 2025/10/17 - 23:14:49 | 400 |      23.851µs |                 | POST     "/api/v1/agents/register"
--- PASS: TestAppResilience (0.00s)
    --- PASS: TestAppResilience/InvalidReport (0.00s)
    --- PASS: TestAppResilience/NonExistentAgent (0.00s)
    --- PASS: TestAppResilience/InvalidDuration (0.00s)
    --- PASS: TestAppResilience/InvalidRegistration (0.00s)
=== RUN   TestAppConfiguration
=== RUN   TestAppConfiguration/DefaultConfig
=== RUN   TestAppConfiguration/CustomConfig
--- PASS: TestAppConfiguration (0.00s)
    --- PASS: TestAppConfiguration/DefaultConfig (0.00s)
    --- PASS: TestAppConfiguration/CustomConfig (0.00s)
=== RUN   TestHealthCheck
[GIN] 2025/10/17 - 23:14:49 | 200 |      15.444µs |                 | GET      "/health"
--- PASS: TestHealthCheck (0.00s)
=== RUN   TestPing
[GIN] 2025/10/17 - 23:14:49 | 200 |       9.677µs |                 | GET      "/api/v1/ping"
--- PASS: TestPing (0.00s)
=== RUN   TestRegisterAgent
2025/10/17 23:14:49 Agent registered: test-agent-1 (hostname: test-host)
[GIN] 2025/10/17 - 23:14:49 | 201 |      20.373µs |                 | POST     "/api/v1/agents/register"
--- PASS: TestRegisterAgent (0.00s)
=== RUN   TestHeartbeat
[GIN] 2025/10/17 - 23:14:49 | 200 |      13.028µs |                 | POST     "/api/v1/agents/heartbeat/test-agent-1"
--- PASS: TestHeartbeat (0.00s)
=== RUN   TestSubmitReport
2025/10/17 23:14:49 Report received from agent: test-agent-1 (hostname: test-host)
[GIN] 2025/10/17 - 23:14:49 | 202 |      52.226µs |                 | POST     "/api/v1/reports"
--- PASS: TestSubmitReport (0.00s)
=== RUN   TestGetTopology
[GIN] 2025/10/17 - 23:14:49 | 200 |      17.099µs |                 | GET      "/api/v1/query/topology"
--- PASS: TestGetTopology (0.00s)
=== RUN   TestGetStats
[GIN] 2025/10/17 - 23:14:49 | 200 |      14.664µs |                 | GET      "/api/v1/query/stats"
--- PASS: TestGetStats (0.00s)
=== RUN   TestGetLatestReport
[GIN] 2025/10/17 - 23:14:49 | 200 |      10.063µs |                 | GET      "/api/v1/query/agents/test-agent-1/latest"
--- PASS: TestGetLatestReport (0.00s)
=== RUN   TestGetLatestReportNotFound
[GIN] 2025/10/17 - 23:14:49 | 404 |       5.692µs |                 | GET      "/api/v1/query/agents/non-existent/latest"
--- PASS: TestGetLatestReportNotFound (0.00s)
=== RUN   TestGetTimeSeries
[GIN] 2025/10/17 - 23:14:49 | 200 |      21.705µs |                 | GET      "/api/v1/query/agents/test-agent-1/timeseries?duration=1h"
--- PASS: TestGetTimeSeries (0.00s)
=== RUN   TestListAgents
[GIN] 2025/10/17 - 23:14:49 | 200 |      15.868µs |                 | GET      "/api/v1/agents/list"
--- PASS: TestListAgents (0.00s)
=== RUN   TestServerStartStop
2025/10/17 23:14:49 Starting app server on localhost:8080
2025/10/17 23:14:49 App server started successfully
2025/10/17 23:14:49 REST API: http://localhost:8080/api/v1
2025/10/17 23:14:49 WebSocket: ws://localhost:8080/api/v1/ws
2025/10/17 23:14:49 Health check: http://localhost:8080/health
2025/10/17 23:14:49 HTTP server error: listen tcp 127.0.0.1:8080: bind: address already in use
2025/10/17 23:14:49 Stopping app server...
2025/10/17 23:14:49 App server stopped successfully
--- PASS: TestServerStartStop (0.10s)
=== RUN   TestE2EFullWorkflow
2025/10/17 23:14:49 Starting app server on localhost:8080
2025/10/17 23:14:49 App server started successfully
2025/10/17 23:14:49 REST API: http://localhost:8080/api/v1
2025/10/17 23:14:49 WebSocket: ws://localhost:8080/api/v1/ws
2025/10/17 23:14:49 Health check: http://localhost:8080/health
2025/10/17 23:14:49 HTTP server error: listen tcp 127.0.0.1:8080: bind: address already in use
[GIN] 2025/10/17 - 23:14:49 | 200 |      68.114µs |                 | GET      "/health"
2025/10/17 23:14:49 Agent registered: e2e-agent-0 (hostname: e2e-host-0)
[GIN] 2025/10/17 - 23:14:49 | 201 |      33.501µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:49 Agent registered: e2e-agent-1 (hostname: e2e-host-1)
[GIN] 2025/10/17 - 23:14:49 | 201 |       5.944µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:49 Agent registered: e2e-agent-2 (hostname: e2e-host-2)
[GIN] 2025/10/17 - 23:14:49 | 201 |       4.774µs |                 | POST     "/api/v1/agents/register"
[GIN] 2025/10/17 - 23:14:49 | 200 |      10.234µs |                 | GET      "/api/v1/agents/list"
2025/10/17 23:14:49 Report received from agent: e2e-agent-0 (hostname: e2e-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |      71.673µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: e2e-agent-1 (hostname: e2e-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |       31.56µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: e2e-agent-2 (hostname: e2e-host-2)
[GIN] 2025/10/17 - 23:14:49 | 202 |      30.865µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 200 |     186.032µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:49 | 200 |      42.238µs |                 | GET      "/api/v1/query/agents/e2e-agent-0/latest"
[GIN] 2025/10/17 - 23:14:49 | 200 |      12.373µs |                 | GET      "/api/v1/query/agents/e2e-agent-1/latest"
[GIN] 2025/10/17 - 23:14:49 | 200 |      13.537µs |                 | GET      "/api/v1/query/agents/e2e-agent-2/latest"
[GIN] 2025/10/17 - 23:14:49 | 200 |      74.023µs |                 | GET      "/api/v1/query/agents/e2e-agent-0/timeseries?duration=1h"
[GIN] 2025/10/17 - 23:14:49 | 200 |       6.776µs |                 | POST     "/api/v1/agents/heartbeat/e2e-agent-0"
[GIN] 2025/10/17 - 23:14:49 | 200 |       3.657µs |                 | POST     "/api/v1/agents/heartbeat/e2e-agent-1"
[GIN] 2025/10/17 - 23:14:49 | 200 |       4.699µs |                 | POST     "/api/v1/agents/heartbeat/e2e-agent-2"
[GIN] 2025/10/17 - 23:14:49 | 200 |      19.126µs |                 | GET      "/api/v1/query/stats"
    integration_e2e_test.go:229: E2E test completed successfully
    integration_e2e_test.go:230: Final stats: map[agents:3 storage:map[max_age:1h0m0s resolution:15s total_agents:3 total_points:3] topology:map[edges_by_type:map[network:3 parent-child:6] last_update:2025-10-17T23:14:49.353885747-07:00 nodes_by_type:map[container:3 host:3 process:3] total_edges:9 total_nodes:9] uptime:301.738689ms websocket_clients:0]
2025/10/17 23:14:49 Stopping app server...
2025/10/17 23:14:49 App server stopped successfully
--- PASS: TestE2EFullWorkflow (0.30s)
=== RUN   TestE2EWebSocketIntegration
2025/10/17 23:14:49 Starting app server on localhost:8080
2025/10/17 23:14:49 App server started successfully
2025/10/17 23:14:49 REST API: http://localhost:8080/api/v1
2025/10/17 23:14:49 WebSocket: ws://localhost:8080/api/v1/ws
2025/10/17 23:14:49 Health check: http://localhost:8080/health
2025/10/17 23:14:49 HTTP server error: listen tcp 127.0.0.1:8080: bind: address already in use
    integration_e2e_test.go:264: WebSocket hub test completed - hub is operational
2025/10/17 23:14:49 Stopping app server...
2025/10/17 23:14:49 App server stopped successfully
--- PASS: TestE2EWebSocketIntegration (0.10s)
=== RUN   TestE2ECleanupWorkflow
2025/10/17 23:14:49 Starting app server on localhost:8080
2025/10/17 23:14:49 App server started successfully
2025/10/17 23:14:49 REST API: http://localhost:8080/api/v1
2025/10/17 23:14:49 WebSocket: ws://localhost:8080/api/v1/ws
2025/10/17 23:14:49 Health check: http://localhost:8080/health
2025/10/17 23:14:49 HTTP server error: listen tcp 127.0.0.1:8080: bind: address already in use
2025/10/17 23:14:49 Running cleanup...
2025/10/17 23:14:49 Cleanup completed. Removed 0 stale agents
    integration_e2e_test.go:316: Cleanup test completed - verified stale nodes removed and recent nodes retained
2025/10/17 23:14:49 Stopping app server...
2025/10/17 23:14:49 App server stopped successfully
--- PASS: TestE2ECleanupWorkflow (0.10s)
=== RUN   TestE2EConcurrentAgents
2025/10/17 23:14:49 Starting app server on localhost:8080
2025/10/17 23:14:49 App server started successfully
2025/10/17 23:14:49 REST API: http://localhost:8080/api/v1
2025/10/17 23:14:49 WebSocket: ws://localhost:8080/api/v1/ws
2025/10/17 23:14:49 Health check: http://localhost:8080/health
2025/10/17 23:14:49 HTTP server error: listen tcp 127.0.0.1:8080: bind: address already in use
2025/10/17 23:14:49 Agent registered: concurrent-agent-0 (hostname: concurrent-host-0)
[GIN] 2025/10/17 - 23:14:49 | 201 |       63.27µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:49 Agent registered: concurrent-agent-4 (hostname: concurrent-host-4)
[GIN] 2025/10/17 - 23:14:49 | 201 |     195.372µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:49 Agent registered: concurrent-agent-3 (hostname: concurrent-host-3)
[GIN] 2025/10/17 - 23:14:49 | 201 |     210.133µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-0 (hostname: concurrent-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |      79.677µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Agent registered: concurrent-agent-2 (hostname: concurrent-host-2)
[GIN] 2025/10/17 - 23:14:49 | 201 |     265.079µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-4 (hostname: concurrent-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |      48.207µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Agent registered: concurrent-agent-1 (hostname: concurrent-host-1)
[GIN] 2025/10/17 - 23:14:49 | 201 |     295.305µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-3 (hostname: concurrent-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |      68.813µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-1 (hostname: concurrent-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |      29.778µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-2 (hostname: concurrent-host-2)
[GIN] 2025/10/17 - 23:14:49 | 202 |       78.78µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-1 (hostname: concurrent-host-1)
2025/10/17 23:14:49 Report received from agent: concurrent-agent-4 (hostname: concurrent-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |     141.865µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |     135.707µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-0 (hostname: concurrent-host-0)
2025/10/17 23:14:49 Report received from agent: concurrent-agent-2 (hostname: concurrent-host-2)
[GIN] 2025/10/17 - 23:14:49 | 202 |      148.48µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |     203.523µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-3 (hostname: concurrent-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |     224.874µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-2 (hostname: concurrent-host-2)
2025/10/17 23:14:49 Report received from agent: concurrent-agent-4 (hostname: concurrent-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |       96.89µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-1 (hostname: concurrent-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |     121.957µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |     134.999µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-0 (hostname: concurrent-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |     170.802µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: concurrent-agent-3 (hostname: concurrent-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |     200.078µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 200 |     130.657µs |                 | GET      "/api/v1/agents/list"
    integration_e2e_test.go:401: Concurrent agents test completed with 5 agents
2025/10/17 23:14:49 Stopping app server...
2025/10/17 23:14:49 App server stopped successfully
--- PASS: TestE2EConcurrentAgents (0.13s)
=== RUN   TestLoadMultipleProbes
2025/10/17 23:14:49 Agent registered: load-test-agent-4 (hostname: load-test-host-4)
2025/10/17 23:14:49 Agent registered: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:49 Agent registered: load-test-agent-1 (hostname: load-test-host-1)
2025/10/17 23:14:49 Agent registered: load-test-agent-0 (hostname: load-test-host-0)
2025/10/17 23:14:49 Agent registered: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 201 |      54.685µs |                 | POST     "/api/v1/agents/register"
[GIN] 2025/10/17 - 23:14:49 | 201 |       35.19µs |                 | POST     "/api/v1/agents/register"
[GIN] 2025/10/17 - 23:14:49 | 201 |       61.15µs |                 | POST     "/api/v1/agents/register"
[GIN] 2025/10/17 - 23:14:49 | 201 |       38.48µs |                 | POST     "/api/v1/agents/register"
[GIN] 2025/10/17 - 23:14:49 | 201 |      54.672µs |                 | POST     "/api/v1/agents/register"
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |      35.457µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |      52.756µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |      46.322µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |       27.32µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:49 | 202 |      73.398µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |     113.484µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |      44.048µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |     132.384µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |     104.399µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |       98.17µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |     108.502µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |     112.124µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |     131.483µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |     140.278µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |     151.869µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |      73.376µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |     120.343µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |     113.856µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |     141.007µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |     132.492µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |     101.305µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |      103.29µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:49 | 202 |     111.662µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |     124.356µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |      72.451µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |      64.556µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |      67.154µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:49 | 202 |      89.534µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |     100.154µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |     122.202µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |      83.247µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |      78.595µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |      98.953µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |     109.777µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |      120.86µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:49 | 202 |      92.283µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |     121.805µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |     124.981µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |     135.274µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |     150.679µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |      62.323µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:49 | 202 |      66.617µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |      79.842µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |      95.108µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |     113.389µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |      122.74µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |      77.119µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:49 | 202 |     150.594µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |     171.765µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |     190.971µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:49 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:49 | 202 |      76.221µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:49 | 202 |      66.428µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:49 | 202 |      96.901µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:49 | 202 |      98.303µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:49 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:49 | 202 |     100.612µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
2025/10/17 23:14:50 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:50 | 202 |     146.657µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |     163.895µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |     225.211µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |     250.198µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |      271.64µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
2025/10/17 23:14:50 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      38.057µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      75.321µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |      99.509µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
2025/10/17 23:14:50 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:50 | 202 |       17.58µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      25.957µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
2025/10/17 23:14:50 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
2025/10/17 23:14:50 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      71.512µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
2025/10/17 23:14:50 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |       48.97µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      34.858µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |       47.32µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      34.013µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
2025/10/17 23:14:50 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      68.292µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
2025/10/17 23:14:50 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |      93.988µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      44.003µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      37.328µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |     105.493µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
2025/10/17 23:14:50 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:50 | 202 |      54.601µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      59.524µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
2025/10/17 23:14:50 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |      67.933µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      73.524µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |      76.524µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:50 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      73.676µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |       72.13µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      67.359µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
2025/10/17 23:14:50 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:50 | 202 |      104.85µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      111.87µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      68.264µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:50 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |       95.01µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      77.496µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
[GIN] 2025/10/17 - 23:14:50 | 202 |     113.713µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:50 | 202 |     123.168µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
2025/10/17 23:14:50 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:50 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      57.891µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |      59.903µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      38.631µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      74.974µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
[GIN] 2025/10/17 - 23:14:50 | 202 |      89.085µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-3 (hostname: load-test-host-3)
2025/10/17 23:14:50 Report received from agent: load-test-agent-2 (hostname: load-test-host-2)
2025/10/17 23:14:50 Report received from agent: load-test-agent-4 (hostname: load-test-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |      49.985µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      54.796µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      54.182µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: load-test-agent-1 (hostname: load-test-host-1)
2025/10/17 23:14:50 Report received from agent: load-test-agent-0 (hostname: load-test-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      63.282µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |      34.629µs |                 | POST     "/api/v1/reports"
    loadtest_test.go:102: Load test completed in 206.505601ms
    loadtest_test.go:103: Total requests: 100
    loadtest_test.go:104: Successful reports: 100
    loadtest_test.go:105: Failed reports: 0
    loadtest_test.go:106: Requests per second: 484.25
    loadtest_test.go:118: Storage stats: map[max_age:1h0m0s resolution:15s total_agents:5 total_points:100]
--- PASS: TestLoadMultipleProbes (0.21s)
=== RUN   TestLoadConcurrentReads
[GIN] 2025/10/17 - 23:14:50 | 200 |      65.959µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      78.237µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      58.533µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      11.966µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.535µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       2.941µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      14.834µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      17.348µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      44.633µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.385µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.984µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |        9.55µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       14.09µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.256µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |     153.387µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.041µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      48.609µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      56.379µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      22.183µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.717µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |      17.765µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      200.39µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |     186.235µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      68.295µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      17.084µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |     273.898µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      29.698µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      33.003µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      12.352µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |     484.188µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       7.283µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       8.864µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |      86.857µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      18.908µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       7.381µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.203µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.435µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |     329.837µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       7.783µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       9.834µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |      19.538µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.128µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.524µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |        5.38µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      13.566µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      40.449µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |        2.05µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |      37.234µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      23.016µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.889µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.967µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      34.168µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      16.639µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       8.824µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      18.065µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |     385.967µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      19.199µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.924µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       17.44µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.869µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      34.051µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      25.217µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      26.231µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      12.675µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      17.174µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      385.89µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.606µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       2.424µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      60.715µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       7.097µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      12.103µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      27.711µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       8.058µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.238µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.437µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      23.112µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |      19.589µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      29.594µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       7.315µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      20.466µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       14.04µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.854µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |        3.15µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       2.646µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      15.035µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      18.551µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.052µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.116µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       8.561µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.247µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.378µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       36.35µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      45.818µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       8.698µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      26.702µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      16.667µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      22.109µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.266µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.865µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |         4.9µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.506µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      31.248µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      23.688µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      18.962µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      37.649µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      21.185µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      21.157µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      16.598µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.645µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |      20.885µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.065µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      17.134µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |        4.52µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       1.709µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       1.943µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.277µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      12.036µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      17.712µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      19.688µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      22.951µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      22.452µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.411µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       7.467µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      38.568µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      14.205µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      21.404µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.406µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |      58.193µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.681µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.572µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       1.889µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       2.969µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |      16.717µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.488µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.059µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.657µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       4.543µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.805µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.483µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      14.364µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.909µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      28.331µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       7.917µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       1.932µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.305µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      48.975µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      15.525µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |         9.6µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      24.669µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      15.092µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.726µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.895µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |      13.944µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.719µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      10.849µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.326µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.782µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       2.491µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |      44.631µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.781µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.647µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.895µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |     145.083µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |     165.332µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       7.398µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |      12.827µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       1.642µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |     147.688µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      11.151µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       2.008µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       6.746µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.481µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       9.372µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      10.946µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       1.956µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       5.637µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.586µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |     147.533µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |        3.83µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |     156.989µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.659µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |        8.93µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       2.768µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       8.249µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |        3.44µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       2.954µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.559µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.172µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       13.26µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      13.074µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       8.452µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       8.352µs |                 | GET      "/api/v1/query/stats"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.138µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       2.641µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.123µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       1.396µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |     130.025µs |                 | GET      "/api/v1/agents/list"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.968µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.262µs |                 | GET      "/health"
[GIN] 2025/10/17 - 23:14:50 | 200 |       3.566µs |                 | GET      "/health"
    loadtest_test.go:197: Concurrent read test completed in 1.488278ms
    loadtest_test.go:198: Total reads: 200
    loadtest_test.go:199: Successful reads: 200
    loadtest_test.go:200: Reads per second: 134383.50
--- PASS: TestLoadConcurrentReads (0.00s)
=== RUN   TestLoadMixedWorkload
2025/10/17 23:14:50 Report received from agent: worker-agent-4 (hostname: worker-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |      65.417µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: worker-agent-0 (hostname: worker-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      39.645µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      19.067µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-2 (hostname: worker-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |      81.487µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      21.731µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      80.355µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-2 (hostname: worker-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |      20.611µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      18.209µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-0 (hostname: worker-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      56.861µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      17.897µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-0 (hostname: worker-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      19.089µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      17.122µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-1 (hostname: worker-host-1)
[GIN] 2025/10/17 - 23:14:50 | 202 |     270.996µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: worker-agent-3 (hostname: worker-host-3)
[GIN] 2025/10/17 - 23:14:50 | 202 |     281.465µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: worker-agent-0 (hostname: worker-host-0)
[GIN] 2025/10/17 - 23:14:50 | 200 |      25.677µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 202 |      36.369µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: worker-agent-4 (hostname: worker-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |     263.956µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      16.366µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-4 (hostname: worker-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |       10.92µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      77.536µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-2 (hostname: worker-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |     216.778µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      15.082µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-3 (hostname: worker-host-3)
[GIN] 2025/10/17 - 23:14:50 | 202 |      25.898µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: worker-agent-1 (hostname: worker-host-1)
2025/10/17 23:14:50 Report received from agent: worker-agent-2 (hostname: worker-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |      11.944µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |     111.948µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      16.876µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      27.721µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-2 (hostname: worker-host-2)
[GIN] 2025/10/17 - 23:14:50 | 202 |       9.636µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      30.956µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-3 (hostname: worker-host-3)
[GIN] 2025/10/17 - 23:14:50 | 200 |      20.706µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      19.756µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 202 |      21.404µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: worker-agent-1 (hostname: worker-host-1)
[GIN] 2025/10/17 - 23:14:50 | 202 |      24.292µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      58.065µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |       42.59µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-4 (hostname: worker-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |      76.867µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      27.447µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-4 (hostname: worker-host-4)
[GIN] 2025/10/17 - 23:14:50 | 202 |      19.388µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |      124.22µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-1 (hostname: worker-host-1)
[GIN] 2025/10/17 - 23:14:50 | 200 |      28.972µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-0 (hostname: worker-host-0)
[GIN] 2025/10/17 - 23:14:50 | 202 |      26.542µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 202 |     150.669µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |     207.479µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-3 (hostname: worker-host-3)
[GIN] 2025/10/17 - 23:14:50 | 202 |      369.39µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |     268.833µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      39.242µs |                 | GET      "/api/v1/query/topology"
2025/10/17 23:14:50 Report received from agent: worker-agent-1 (hostname: worker-host-1)
[GIN] 2025/10/17 - 23:14:50 | 202 |     143.424µs |                 | POST     "/api/v1/reports"
2025/10/17 23:14:50 Report received from agent: worker-agent-3 (hostname: worker-host-3)
[GIN] 2025/10/17 - 23:14:50 | 202 |      21.467µs |                 | POST     "/api/v1/reports"
[GIN] 2025/10/17 - 23:14:50 | 200 |       17.54µs |                 | GET      "/api/v1/query/topology"
[GIN] 2025/10/17 - 23:14:50 | 200 |      23.922µs |                 | GET      "/api/v1/query/topology"
    loadtest_test.go:270: Mixed workload test completed in 1.120952ms
    loadtest_test.go:271: Total operations: 50
    loadtest_test.go:272: Successful writes: 25
    loadtest_test.go:273: Successful reads: 25
    loadtest_test.go:274: Operations per second: 44604.94
--- PASS: TestLoadMixedWorkload (0.00s)
=== RUN   TestMemoryUsage
2025/10/17 23:14:50 Starting app server on localhost:8080
2025/10/17 23:14:50 App server started successfully
2025/10/17 23:14:50 REST API: http://localhost:8080/api/v1
2025/10/17 23:14:50 WebSocket: ws://localhost:8080/api/v1/ws
2025/10/17 23:14:50 Health check: http://localhost:8080/health
    loadtest_test.go:372: Server stats after 100 reports: map[agents:0 storage:map[max_age:1h0m0s resolution:15s total_agents:10 total_points:100] topology:map[edges_by_type:map[] last_update:2025-10-17 23:14:50.098665757 -0700 PDT m=+1.563007363 nodes_by_type:map[host:10] total_edges:0 total_nodes:10] uptime:165.866µs websocket_clients:0]
2025/10/17 23:14:50 Running cleanup...
2025/10/17 23:14:50 Cleanup completed. Removed 0 stale agents
    loadtest_test.go:378: Server stats after cleanup: map[agents:0 storage:map[max_age:1h0m0s resolution:15s total_agents:10 total_points:100] topology:map[edges_by_type:map[] last_update:2025-10-17 23:14:50.098665757 -0700 PDT m=+1.563007363 nodes_by_type:map[host:10] total_edges:0 total_nodes:10] uptime:218.664µs websocket_clients:0]
2025/10/17 23:14:50 Stopping app server...
2025/10/17 23:14:50 HTTP server error: listen tcp 127.0.0.1:8080: bind: address already in use
2025/10/17 23:14:50 App server stopped successfully
--- PASS: TestMemoryUsage (0.00s)
=== RUN   TestServerCleanup
2025/10/17 23:14:50 Running cleanup...
2025/10/17 23:14:50 Removed stale agent: stale-agent
2025/10/17 23:14:50 Cleanup completed. Removed 1 stale agents
--- PASS: TestServerCleanup (0.00s)
=== RUN   TestServerCleanup_EmptyAgents
2025/10/17 23:14:50 Running cleanup...
2025/10/17 23:14:50 Cleanup completed. Removed 0 stale agents
--- PASS: TestServerCleanup_EmptyAgents (0.00s)
=== RUN   TestServerCleanup_AllStaleAgents
2025/10/17 23:14:50 Running cleanup...
2025/10/17 23:14:50 Removed stale agent: stale-b
2025/10/17 23:14:50 Removed stale agent: stale-c
2025/10/17 23:14:50 Removed stale agent: stale-d
2025/10/17 23:14:50 Removed stale agent: stale-e
2025/10/17 23:14:50 Removed stale agent: stale-a
2025/10/17 23:14:50 Cleanup completed. Removed 5 stale agents
--- PASS: TestServerCleanup_AllStaleAgents (0.00s)
=== RUN   TestServerCleanupLoop
2025/10/17 23:14:50 Starting app server on localhost:8082
2025/10/17 23:14:50 App server started successfully
2025/10/17 23:14:50 REST API: http://localhost:8082/api/v1
2025/10/17 23:14:50 WebSocket: ws://localhost:8082/api/v1/ws
2025/10/17 23:14:50 Health check: http://localhost:8082/health
2025/10/17 23:14:50 Running cleanup...
2025/10/17 23:14:50 Removed stale agent: will-be-stale
2025/10/17 23:14:50 Cleanup completed. Removed 1 stale agents
2025/10/17 23:14:50 Running cleanup...
2025/10/17 23:14:50 Cleanup completed. Removed 0 stale agents
2025/10/17 23:14:50 Stopping app server...
2025/10/17 23:14:50 App server stopped successfully
--- PASS: TestServerCleanupLoop (0.25s)
=== RUN   TestCORSMiddleware
=== RUN   TestCORSMiddleware/OPTIONS_request
=== RUN   TestCORSMiddleware/GET_request
=== RUN   TestCORSMiddleware/POST_request
--- PASS: TestCORSMiddleware (0.00s)
    --- PASS: TestCORSMiddleware/OPTIONS_request (0.00s)
    --- PASS: TestCORSMiddleware/GET_request (0.00s)
    --- PASS: TestCORSMiddleware/POST_request (0.00s)
=== RUN   TestCORSMiddleware_AllMethods
=== RUN   TestCORSMiddleware_AllMethods/GET
=== RUN   TestCORSMiddleware_AllMethods/POST
=== RUN   TestCORSMiddleware_AllMethods/PUT
=== RUN   TestCORSMiddleware_AllMethods/DELETE
=== RUN   TestCORSMiddleware_AllMethods/OPTIONS
--- PASS: TestCORSMiddleware_AllMethods (0.00s)
    --- PASS: TestCORSMiddleware_AllMethods/GET (0.00s)
    --- PASS: TestCORSMiddleware_AllMethods/POST (0.00s)
    --- PASS: TestCORSMiddleware_AllMethods/PUT (0.00s)
    --- PASS: TestCORSMiddleware_AllMethods/DELETE (0.00s)
    --- PASS: TestCORSMiddleware_AllMethods/OPTIONS (0.00s)
=== RUN   TestCORSMiddleware_CustomHeaders
--- PASS: TestCORSMiddleware_CustomHeaders (0.00s)
=== RUN   TestServerCleanup_ConcurrentAccess
2025/10/17 23:14:50 Running cleanup...
2025/10/17 23:14:50 Cleanup completed. Removed 0 stale agents
--- PASS: TestServerCleanup_ConcurrentAccess (0.00s)
=== RUN   TestServerStart_AlreadyRunning
2025/10/17 23:14:50 Starting app server on localhost:8083
2025/10/17 23:14:50 App server started successfully
2025/10/17 23:14:50 REST API: http://localhost:8083/api/v1
2025/10/17 23:14:50 WebSocket: ws://localhost:8083/api/v1/ws
2025/10/17 23:14:50 Health check: http://localhost:8083/health
2025/10/17 23:14:50 Stopping app server...
2025/10/17 23:14:50 App server stopped successfully
--- PASS: TestServerStart_AlreadyRunning (0.00s)
=== RUN   TestServerStop_NotRunning
--- PASS: TestServerStop_NotRunning (0.00s)
=== RUN   TestServerGetStats
--- PASS: TestServerGetStats (0.00s)
=== RUN   TestServerAgentInfo
--- PASS: TestServerAgentInfo (0.00s)
=== RUN   TestWSClientSendMessage_ClosedClient
    websocket_edge_cases_test.go:20: Cannot reach echo server for test
--- SKIP: TestWSClientSendMessage_ClosedClient (0.02s)
=== RUN   TestWSClientSendMessage_FullBuffer
    websocket_edge_cases_test.go:42: Cannot reach echo server for test
--- SKIP: TestWSClientSendMessage_FullBuffer (0.02s)
=== RUN   TestBroadcastTopologyUpdate_WithClients
--- PASS: TestBroadcastTopologyUpdate_WithClients (0.05s)
=== RUN   TestBroadcastReportUpdate_WithPayload
--- PASS: TestBroadcastReportUpdate_WithPayload (0.05s)
=== RUN   TestWSHub_Stop
    websocket_edge_cases_test.go:115: Cannot reach echo server for test
--- SKIP: TestWSHub_Stop (0.03s)
=== RUN   TestWSClientReadPump_InvalidJSON
    websocket_edge_cases_test.go:149: Cannot reach echo server for test
--- SKIP: TestWSClientReadPump_InvalidJSON (0.02s)
=== RUN   TestWSClientReadPump_PingMessage
    websocket_edge_cases_test.go:180: Cannot reach echo server for test
--- SKIP: TestWSClientReadPump_PingMessage (0.02s)
=== RUN   TestWSClientReadPump_SubscribeMessage
    websocket_edge_cases_test.go:214: Cannot reach echo server for test
--- SKIP: TestWSClientReadPump_SubscribeMessage (0.02s)
=== RUN   TestWSClientReadPump_UnknownMessageType
    websocket_edge_cases_test.go:247: Cannot reach echo server for test
--- SKIP: TestWSClientReadPump_UnknownMessageType (0.02s)
=== RUN   TestWSClientWritePump_ChannelClosed
    websocket_edge_cases_test.go:278: Cannot reach echo server for test
--- SKIP: TestWSClientWritePump_ChannelClosed (0.02s)
=== RUN   TestWSClientWritePump_QueuedMessages
    websocket_edge_cases_test.go:302: Cannot reach echo server for test
--- SKIP: TestWSClientWritePump_QueuedMessages (0.03s)
=== RUN   TestWSHub_BroadcastWithFullClientBuffer
    websocket_edge_cases_test.go:338: Cannot reach echo server for test
--- SKIP: TestWSHub_BroadcastWithFullClientBuffer (0.03s)
=== RUN   TestBroadcastTopologyUpdateWithMarshalError
--- PASS: TestBroadcastTopologyUpdateWithMarshalError (0.10s)
=== RUN   TestBroadcastReportUpdateWithMarshalError
2025/10/17 23:14:50 Failed to broadcast report update: json: unsupported type: chan int
--- PASS: TestBroadcastReportUpdateWithMarshalError (0.10s)
=== RUN   TestBroadcastWithChannelError
--- PASS: TestBroadcastWithChannelError (0.00s)
=== RUN   TestWebSocketHandler_Upgrade
=== RUN   TestWebSocketHandler_Upgrade/Valid_WebSocket_upgrade


[31m2025/10/17 23:14:50 [Recovery] 2025/10/17 - 23:14:50 panic recovered:
interface conversion: *httptest.ResponseRecorder is not http.Hijacker: missing method Hijack
/home/calelin/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.23.7.linux-amd64/src/runtime/iface.go:102 (0x4705a4)
	getitab: panic(&TypeAssertionError{concrete: typ, asserted: &inter.Type, missingMethod: itabInit(m, false)})
/home/calelin/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.23.7.linux-amd64/src/runtime/iface.go:474 (0x41029e)
	typeAssert: tab = getitab(s.Inter, t, s.CanFail)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/response_writer.go:118 (0xec8e69)
	(*responseWriter).Hijack: return w.ResponseWriter.(http.Hijacker).Hijack()
/home/calelin/go/pkg/mod/github.com/gorilla/websocket@v1.5.3/server.go:180 (0x8d0958)
	(*Upgrader).Upgrade: netConn, brw, err := h.Hijack()
/home/calelin/dev/orchestrator/pkg/app/handlers.go:272 (0xf27a19)
	(*Handlers).WebSocketHandler: conn, err := upgrader.Upgrade(c.Writer, c.Request, nil)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/context.go:192 (0xeb8bad)
	(*Context).Next: c.handlers[c.index](c)
/home/calelin/dev/orchestrator/pkg/app/server.go:277 (0xf53de4)
	NewServer.CORSMiddleware.func1: c.Next()
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/context.go:192 (0xeb8bad)
	(*Context).Next: c.handlers[c.index](c)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/recovery.go:92 (0xec7ab0)
	CustomRecoveryWithWriter.func1: c.Next()
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/context.go:192 (0xeb8bad)
	(*Context).Next: c.handlers[c.index](c)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/logger.go:249 (0xec6c2d)
	LoggerWithConfig.func1: c.Next()
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/context.go:192 (0xeb8bad)
	(*Context).Next: c.handlers[c.index](c)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/gin.go:689 (0xec5c6f)
	(*Engine).handleHTTPRequest: c.Next()
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/gin.go:643 (0xec5611)
	(*Engine).ServeHTTP: engine.handleHTTPRequest(c)
/home/calelin/dev/orchestrator/pkg/app/websocket_handler_test.go:69 (0xf4d13d)
	TestWebSocketHandler_Upgrade.func1: server.router.ServeHTTP(w, req)
/home/calelin/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.23.7.linux-amd64/src/testing/testing.go:1690 (0x5b1e73)
	tRunner: fn(t)
/home/calelin/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.23.7.linux-amd64/src/runtime/asm_amd64.s:1700 (0x47f020)
	goexit: BYTE	$0x90	// NOP
[0m
[GIN] 2025/10/17 - 23:14:50 | 200 |    1.149837ms |       192.0.2.1 | GET      "/api/v1/ws"
=== RUN   TestWebSocketHandler_Upgrade/Missing_Upgrade_header
2025/10/17 23:14:50 Failed to upgrade WebSocket connection: websocket: the client is not using the websocket protocol: 'websocket' token not found in 'Upgrade' header
[GIN] 2025/10/17 - 23:14:50 | 400 |      33.013µs |       192.0.2.1 | GET      "/api/v1/ws"
=== RUN   TestWebSocketHandler_Upgrade/Invalid_WebSocket_version
2025/10/17 23:14:50 Failed to upgrade WebSocket connection: websocket: unsupported version: 13 not found in 'Sec-Websocket-Version' header
[GIN] 2025/10/17 - 23:14:50 | 400 |      20.447µs |       192.0.2.1 | GET      "/api/v1/ws"
--- PASS: TestWebSocketHandler_Upgrade (0.10s)
    --- PASS: TestWebSocketHandler_Upgrade/Valid_WebSocket_upgrade (0.00s)
    --- PASS: TestWebSocketHandler_Upgrade/Missing_Upgrade_header (0.00s)
    --- PASS: TestWebSocketHandler_Upgrade/Invalid_WebSocket_version (0.00s)
=== RUN   TestWebSocketHandler_ClientConnection
    websocket_handler_test.go:123: Failed to read initial message: read tcp 127.0.0.1:44102->127.0.0.1:45777: i/o timeout
--- PASS: TestWebSocketHandler_ClientConnection (2.00s)
=== RUN   TestWebSocketHandler_MessageHandling


[31m2025/10/17 23:14:53 [Recovery] 2025/10/17 - 23:14:53 panic recovered:
interface conversion: *httptest.ResponseRecorder is not http.Hijacker: missing method Hijack
/home/calelin/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.23.7.linux-amd64/src/runtime/iface.go:102 (0x4705a4)
	getitab: panic(&TypeAssertionError{concrete: typ, asserted: &inter.Type, missingMethod: itabInit(m, false)})
/home/calelin/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.23.7.linux-amd64/src/runtime/iface.go:474 (0x41029e)
	typeAssert: tab = getitab(s.Inter, t, s.CanFail)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/response_writer.go:118 (0xec8e69)
	(*responseWriter).Hijack: return w.ResponseWriter.(http.Hijacker).Hijack()
/home/calelin/go/pkg/mod/github.com/gorilla/websocket@v1.5.3/server.go:180 (0x8d0958)
	(*Upgrader).Upgrade: netConn, brw, err := h.Hijack()
/home/calelin/dev/orchestrator/pkg/app/handlers.go:272 (0xf27a19)
	(*Handlers).WebSocketHandler: conn, err := upgrader.Upgrade(c.Writer, c.Request, nil)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/context.go:192 (0xeb8bad)
	(*Context).Next: c.handlers[c.index](c)
/home/calelin/dev/orchestrator/pkg/app/server.go:277 (0xf53de4)
	NewServer.CORSMiddleware.func1: c.Next()
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/context.go:192 (0xeb8bad)
	(*Context).Next: c.handlers[c.index](c)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/recovery.go:92 (0xec7ab0)
	CustomRecoveryWithWriter.func1: c.Next()
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/context.go:192 (0xeb8bad)
	(*Context).Next: c.handlers[c.index](c)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/logger.go:249 (0xec6c2d)
	LoggerWithConfig.func1: c.Next()
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/context.go:192 (0xeb8bad)
	(*Context).Next: c.handlers[c.index](c)
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/gin.go:689 (0xec5c6f)
	(*Engine).handleHTTPRequest: c.Next()
/home/calelin/go/pkg/mod/github.com/gin-gonic/gin@v1.11.0/gin.go:643 (0xec5611)
	(*Engine).ServeHTTP: engine.handleHTTPRequest(c)
/home/calelin/dev/orchestrator/pkg/app/websocket_handler_test.go:161 (0xf4ddba)
	TestWebSocketHandler_MessageHandling: server.router.ServeHTTP(w, req)
/home/calelin/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.23.7.linux-amd64/src/testing/testing.go:1690 (0x5b1e73)
	tRunner: fn(t)
/home/calelin/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.23.7.linux-amd64/src/runtime/asm_amd64.s:1700 (0x47f020)
	goexit: BYTE	$0x90	// NOP
[0m
[GIN] 2025/10/17 - 23:14:53 | 200 |    2.762258ms |       192.0.2.1 | GET      "/api/v1/ws"
--- PASS: TestWebSocketHandler_MessageHandling (0.00s)
=== RUN   TestWebSocketHandler_ErrorPaths
=== RUN   TestWebSocketHandler_ErrorPaths/Wrong_HTTP_method
[GIN] 2025/10/17 - 23:14:53 | 404 |       1.878µs |       192.0.2.1 | POST     "/api/v1/ws"
    websocket_handler_test.go:221: Wrong method returned status: 404
=== RUN   TestWebSocketHandler_ErrorPaths/Missing_all_headers
2025/10/17 23:14:53 Failed to upgrade WebSocket connection: websocket: the client is not using the websocket protocol: 'upgrade' token not found in 'Connection' header
[GIN] 2025/10/17 - 23:14:53 | 400 |      36.275µs |       192.0.2.1 | GET      "/api/v1/ws"
=== RUN   TestWebSocketHandler_ErrorPaths/Wrong_upgrade_type
2025/10/17 23:14:53 Failed to upgrade WebSocket connection: websocket: the client is not using the websocket protocol: 'websocket' token not found in 'Upgrade' header
[GIN] 2025/10/17 - 23:14:53 | 400 |      16.858µs |       192.0.2.1 | GET      "/api/v1/ws"
--- PASS: TestWebSocketHandler_ErrorPaths (0.00s)
    --- PASS: TestWebSocketHandler_ErrorPaths/Wrong_HTTP_method (0.00s)
    --- PASS: TestWebSocketHandler_ErrorPaths/Missing_all_headers (0.00s)
    --- PASS: TestWebSocketHandler_ErrorPaths/Wrong_upgrade_type (0.00s)
=== RUN   TestWebSocketHandler_ConcurrentConnections
    websocket_handler_test.go:266: Successfully established 5/5 WebSocket connections
    websocket_handler_test.go:273: WebSocket hub reports 0 clients
--- PASS: TestWebSocketHandler_ConcurrentConnections (0.10s)
=== RUN   TestWebSocketHandler_TopologyBroadcast
2025/10/17 23:14:53 Failed to upgrade WebSocket connection: websocket: not a websocket handshake: 'Sec-WebSocket-Key' header must be Base64 encoded value of 16-byte in length
[GIN] 2025/10/17 - 23:14:53 | 400 |      91.435µs |       192.0.2.1 | GET      "/api/v1/ws"
--- PASS: TestWebSocketHandler_TopologyBroadcast (0.00s)
=== RUN   TestWebSocketUpgraderConfiguration
--- PASS: TestWebSocketUpgraderConfiguration (0.00s)
=== RUN   TestNewWSHub
--- PASS: TestNewWSHub (0.00s)
=== RUN   TestWSHubClientRegistration
2025/10/17 23:14:53 WebSocket client registered: test-client (total: 1)
2025/10/17 23:14:53 WebSocket client unregistered: test-client (total: 0)
--- PASS: TestWSHubClientRegistration (0.30s)
=== RUN   TestWSHubBroadcast
2025/10/17 23:14:53 WebSocket client registered: test-client (total: 1)
    websocket_test.go:126: WebSocket message timeout - this may be due to test environment limitations
--- PASS: TestWSHubBroadcast (2.00s)
=== RUN   TestWSHubBroadcastTopologyUpdate
--- PASS: TestWSHubBroadcastTopologyUpdate (0.00s)
=== RUN   TestWSHubBroadcastReportUpdate
--- PASS: TestWSHubBroadcastReportUpdate (0.00s)
=== RUN   TestNewWSClient
--- PASS: TestNewWSClient (0.10s)
=== RUN   TestWSClientSendMessage
--- PASS: TestWSClientSendMessage (0.10s)
=== RUN   TestWSClientClose
--- PASS: TestWSClientClose (0.10s)
=== RUN   TestWSMessageSerialization
--- PASS: TestWSMessageSerialization (0.00s)
=== RUN   TestWSHubGetClientCount
--- PASS: TestWSHubGetClientCount (0.00s)
=== RUN   TestWSClientPumpsIntegration
2025/10/17 23:14:55 WebSocket client registered: test-client (total: 1)
2025/10/17 23:14:56 WebSocket client unregistered: test-client (total: 0)
--- PASS: TestWSClientPumpsIntegration (0.30s)
PASS
coverage: 93.5% of statements
ok  	github.com/ljluestc/orchestrator/pkg/app	7.492s	coverage: 93.5% of statements
