=== RUN   TestNewDRFScheduler
--- PASS: TestNewDRFScheduler (0.00s)
=== RUN   TestDRFScheduler_RegisterTenant
=== RUN   TestDRFScheduler_RegisterTenant/Valid_tenant_with_default_weight
=== RUN   TestDRFScheduler_RegisterTenant/Valid_tenant_with_custom_weight
=== RUN   TestDRFScheduler_RegisterTenant/Tenant_with_zero_weight_(should_default_to_1.0)
=== RUN   TestDRFScheduler_RegisterTenant/Tenant_with_negative_weight_(should_default_to_1.0)
--- PASS: TestDRFScheduler_RegisterTenant (0.00s)
    --- PASS: TestDRFScheduler_RegisterTenant/Valid_tenant_with_default_weight (0.00s)
    --- PASS: TestDRFScheduler_RegisterTenant/Valid_tenant_with_custom_weight (0.00s)
    --- PASS: TestDRFScheduler_RegisterTenant/Tenant_with_zero_weight_(should_default_to_1.0) (0.00s)
    --- PASS: TestDRFScheduler_RegisterTenant/Tenant_with_negative_weight_(should_default_to_1.0) (0.00s)
=== RUN   TestDRFScheduler_ScheduleTask
=== RUN   TestDRFScheduler_ScheduleTask/Valid_task_request
=== RUN   TestDRFScheduler_ScheduleTask/Task_exceeds_tenant_quota
=== RUN   TestDRFScheduler_ScheduleTask/Task_exceeds_cluster_capacity
=== RUN   TestDRFScheduler_ScheduleTask/Non-existent_tenant
--- PASS: TestDRFScheduler_ScheduleTask (0.00s)
    --- PASS: TestDRFScheduler_ScheduleTask/Valid_task_request (0.00s)
    --- PASS: TestDRFScheduler_ScheduleTask/Task_exceeds_tenant_quota (0.00s)
    --- PASS: TestDRFScheduler_ScheduleTask/Task_exceeds_cluster_capacity (0.00s)
    --- PASS: TestDRFScheduler_ScheduleTask/Non-existent_tenant (0.00s)
=== RUN   TestDRFScheduler_checkQuota
=== RUN   TestDRFScheduler_checkQuota/Within_quota
=== RUN   TestDRFScheduler_checkQuota/At_quota_limit
=== RUN   TestDRFScheduler_checkQuota/Exceeds_CPU_quota
=== RUN   TestDRFScheduler_checkQuota/Exceeds_memory_quota
=== RUN   TestDRFScheduler_checkQuota/Exceeds_GPU_quota
=== RUN   TestDRFScheduler_checkQuota/Exceeds_disk_quota
--- PASS: TestDRFScheduler_checkQuota (0.00s)
    --- PASS: TestDRFScheduler_checkQuota/Within_quota (0.00s)
    --- PASS: TestDRFScheduler_checkQuota/At_quota_limit (0.00s)
    --- PASS: TestDRFScheduler_checkQuota/Exceeds_CPU_quota (0.00s)
    --- PASS: TestDRFScheduler_checkQuota/Exceeds_memory_quota (0.00s)
    --- PASS: TestDRFScheduler_checkQuota/Exceeds_GPU_quota (0.00s)
    --- PASS: TestDRFScheduler_checkQuota/Exceeds_disk_quota (0.00s)
=== RUN   TestDRFScheduler_checkClusterCapacity
=== RUN   TestDRFScheduler_checkClusterCapacity/Within_cluster_capacity
=== RUN   TestDRFScheduler_checkClusterCapacity/At_cluster_capacity
=== RUN   TestDRFScheduler_checkClusterCapacity/Exceeds_CPU_capacity
=== RUN   TestDRFScheduler_checkClusterCapacity/Exceeds_memory_capacity
=== RUN   TestDRFScheduler_checkClusterCapacity/Exceeds_GPU_capacity
--- PASS: TestDRFScheduler_checkClusterCapacity (0.00s)
    --- PASS: TestDRFScheduler_checkClusterCapacity/Within_cluster_capacity (0.00s)
    --- PASS: TestDRFScheduler_checkClusterCapacity/At_cluster_capacity (0.00s)
    --- PASS: TestDRFScheduler_checkClusterCapacity/Exceeds_CPU_capacity (0.00s)
    --- PASS: TestDRFScheduler_checkClusterCapacity/Exceeds_memory_capacity (0.00s)
    --- PASS: TestDRFScheduler_checkClusterCapacity/Exceeds_GPU_capacity (0.00s)
=== RUN   TestDRFScheduler_updateDominantShare
=== RUN   TestDRFScheduler_updateDominantShare/CPU_dominant
=== RUN   TestDRFScheduler_updateDominantShare/Memory_dominant
=== RUN   TestDRFScheduler_updateDominantShare/GPU_dominant
=== RUN   TestDRFScheduler_updateDominantShare/With_custom_weight
=== RUN   TestDRFScheduler_updateDominantShare/Zero_GPU_allocation
--- PASS: TestDRFScheduler_updateDominantShare (0.00s)
    --- PASS: TestDRFScheduler_updateDominantShare/CPU_dominant (0.00s)
    --- PASS: TestDRFScheduler_updateDominantShare/Memory_dominant (0.00s)
    --- PASS: TestDRFScheduler_updateDominantShare/GPU_dominant (0.00s)
    --- PASS: TestDRFScheduler_updateDominantShare/With_custom_weight (0.00s)
    --- PASS: TestDRFScheduler_updateDominantShare/Zero_GPU_allocation (0.00s)
=== RUN   TestDRFScheduler_GetSchedulingOrder
--- PASS: TestDRFScheduler_GetSchedulingOrder (0.00s)
=== RUN   TestDRFScheduler_ReleaseResources
=== RUN   TestDRFScheduler_ReleaseResources/Release_partial_resources
=== RUN   TestDRFScheduler_ReleaseResources/Release_all_resources
=== RUN   TestDRFScheduler_ReleaseResources/Non-existent_tenant
--- PASS: TestDRFScheduler_ReleaseResources (0.00s)
    --- PASS: TestDRFScheduler_ReleaseResources/Release_partial_resources (0.00s)
    --- PASS: TestDRFScheduler_ReleaseResources/Release_all_resources (0.00s)
    --- PASS: TestDRFScheduler_ReleaseResources/Non-existent_tenant (0.00s)
=== RUN   TestDRFScheduler_ReleaseResources_NegativeValues
--- PASS: TestDRFScheduler_ReleaseResources_NegativeValues (0.00s)
=== RUN   TestDRFScheduler_GetTenantStats
=== RUN   TestDRFScheduler_GetTenantStats/Valid_tenant
=== RUN   TestDRFScheduler_GetTenantStats/Non-existent_tenant
--- PASS: TestDRFScheduler_GetTenantStats (0.00s)
    --- PASS: TestDRFScheduler_GetTenantStats/Valid_tenant (0.00s)
    --- PASS: TestDRFScheduler_GetTenantStats/Non-existent_tenant (0.00s)
=== RUN   TestDRFScheduler_GetClusterUtilization
--- PASS: TestDRFScheduler_GetClusterUtilization (0.00s)
=== RUN   TestDRFScheduler_ConcurrentAccess
--- PASS: TestDRFScheduler_ConcurrentAccess (0.00s)
=== RUN   TestDRFScheduler_EdgeCases
=== RUN   TestDRFScheduler_EdgeCases/Empty_cluster
=== RUN   TestDRFScheduler_EdgeCases/Zero_resource_request
=== RUN   TestDRFScheduler_EdgeCases/Very_small_resource_values
--- PASS: TestDRFScheduler_EdgeCases (0.00s)
    --- PASS: TestDRFScheduler_EdgeCases/Empty_cluster (0.00s)
    --- PASS: TestDRFScheduler_EdgeCases/Zero_resource_request (0.00s)
    --- PASS: TestDRFScheduler_EdgeCases/Very_small_resource_values (0.00s)
=== RUN   TestNewQuotaEnforcer
=== RUN   TestNewQuotaEnforcer/Hard_enforcement_with_no_preemption
=== RUN   TestNewQuotaEnforcer/Soft_enforcement_with_low_priority_preemption
=== RUN   TestNewQuotaEnforcer/Adaptive_enforcement_with_oldest_preemption
--- PASS: TestNewQuotaEnforcer (0.00s)
    --- PASS: TestNewQuotaEnforcer/Hard_enforcement_with_no_preemption (0.00s)
    --- PASS: TestNewQuotaEnforcer/Soft_enforcement_with_low_priority_preemption (0.00s)
    --- PASS: TestNewQuotaEnforcer/Adaptive_enforcement_with_oldest_preemption (0.00s)
=== RUN   TestQuotaEnforcer_EnforceQuota_HardEnforcement
=== RUN   TestQuotaEnforcer_EnforceQuota_HardEnforcement/Within_quota_limits
=== RUN   TestQuotaEnforcer_EnforceQuota_HardEnforcement/At_quota_limit
=== RUN   TestQuotaEnforcer_EnforceQuota_HardEnforcement/Exceeds_CPU_quota
=== RUN   TestQuotaEnforcer_EnforceQuota_HardEnforcement/Exceeds_memory_quota
=== RUN   TestQuotaEnforcer_EnforceQuota_HardEnforcement/Non-existent_tenant
--- PASS: TestQuotaEnforcer_EnforceQuota_HardEnforcement (0.00s)
    --- PASS: TestQuotaEnforcer_EnforceQuota_HardEnforcement/Within_quota_limits (0.00s)
    --- PASS: TestQuotaEnforcer_EnforceQuota_HardEnforcement/At_quota_limit (0.00s)
    --- PASS: TestQuotaEnforcer_EnforceQuota_HardEnforcement/Exceeds_CPU_quota (0.00s)
    --- PASS: TestQuotaEnforcer_EnforceQuota_HardEnforcement/Exceeds_memory_quota (0.00s)
    --- PASS: TestQuotaEnforcer_EnforceQuota_HardEnforcement/Non-existent_tenant (0.00s)
=== RUN   TestQuotaEnforcer_EnforceQuota_SoftEnforcement
=== RUN   TestQuotaEnforcer_EnforceQuota_SoftEnforcement/Within_quota_limits
=== RUN   TestQuotaEnforcer_EnforceQuota_SoftEnforcement/Exceeds_quota_but_allowed_in_soft_mode
2025/10/17 23:15:53 Soft quota violation for tenant tenant-1: GPU quota exceeded (available: 2.00, requested: 3.00)
--- PASS: TestQuotaEnforcer_EnforceQuota_SoftEnforcement (0.00s)
    --- PASS: TestQuotaEnforcer_EnforceQuota_SoftEnforcement/Within_quota_limits (0.00s)
    --- PASS: TestQuotaEnforcer_EnforceQuota_SoftEnforcement/Exceeds_quota_but_allowed_in_soft_mode (0.00s)
=== RUN   TestQuotaEnforcer_EnforceQuota_AdaptiveMode
=== RUN   TestQuotaEnforcer_EnforceQuota_AdaptiveMode/Low_cluster_utilization_-_allow_oversubscription
2025/10/17 23:15:53 Allowing oversubscription for tenant tenant-1 due to low cluster utilization
=== RUN   TestQuotaEnforcer_EnforceQuota_AdaptiveMode/High_cluster_utilization_-_reject_oversubscription
--- PASS: TestQuotaEnforcer_EnforceQuota_AdaptiveMode (0.00s)
    --- PASS: TestQuotaEnforcer_EnforceQuota_AdaptiveMode/Low_cluster_utilization_-_allow_oversubscription (0.00s)
    --- PASS: TestQuotaEnforcer_EnforceQuota_AdaptiveMode/High_cluster_utilization_-_reject_oversubscription (0.00s)
=== RUN   TestQuotaEnforcer_recordViolation
--- PASS: TestQuotaEnforcer_recordViolation (0.00s)
=== RUN   TestQuotaEnforcer_GetViolationCount
--- PASS: TestQuotaEnforcer_GetViolationCount (0.00s)
=== RUN   TestQuotaEnforcer_estimateWaitTime
--- PASS: TestQuotaEnforcer_estimateWaitTime (0.00s)
=== RUN   TestQuotaEnforcer_attemptPreemption
--- PASS: TestQuotaEnforcer_attemptPreemption (0.00s)
=== RUN   TestQuotaEnforcer_MonitorQuotas
2025/10/17 23:15:53 === Quota Status Report ===
2025/10/17 23:15:53 Tenant: Tenant Two | CPU: 0.0% | Memory: 0.0% | GPU: 0.0% | Dominant Share: 0.150 | Violations: 0
2025/10/17 23:15:53 Tenant: Tenant One | CPU: 0.0% | Memory: 0.0% | GPU: 0.0% | Dominant Share: 0.100 | Violations: 2
2025/10/17 23:15:53 Cluster Utilization: CPU: 25.0%, Memory: 25.0%, GPU: 25.0%
--- PASS: TestQuotaEnforcer_MonitorQuotas (0.10s)
2025/10/17 23:15:53 === Quota Status Report ===
=== RUN   TestQuotaEnforcer_SetEnforcementMode
2025/10/17 23:15:53 Tenant: Tenant Two | CPU: 0.0% | Memory: 0.0% | GPU: 0.0% | Dominant Share: 0.150 | Violations: 0
2025/10/17 23:15:53 Tenant: Tenant One | CPU: 0.0% | Memory: 0.0% | GPU: 0.0% | Dominant Share: 0.100 | Violations: 2
2025/10/17 23:15:53 Cluster Utilization: CPU: 25.0%, Memory: 25.0%, GPU: 25.0%
2025/10/17 23:15:53 Quota enforcement mode changed to: soft
2025/10/17 23:15:53 Quota enforcement mode changed to: adaptive
2025/10/17 23:15:53 Quota enforcement mode changed to: hard
--- PASS: TestQuotaEnforcer_SetEnforcementMode (0.00s)
=== RUN   TestQuotaEnforcer_ResetViolations
--- PASS: TestQuotaEnforcer_ResetViolations (0.00s)
=== RUN   TestQuotaEnforcer_ConcurrentAccess
--- PASS: TestQuotaEnforcer_ConcurrentAccess (0.00s)
=== RUN   TestQuotaEnforcer_EdgeCases
=== RUN   TestQuotaEnforcer_EdgeCases/Empty_scheduler
=== RUN   TestQuotaEnforcer_EdgeCases/Zero_resource_request
=== RUN   TestQuotaEnforcer_EdgeCases/Context_cancellation
--- PASS: TestQuotaEnforcer_EdgeCases (0.00s)
    --- PASS: TestQuotaEnforcer_EdgeCases/Empty_scheduler (0.00s)
    --- PASS: TestQuotaEnforcer_EdgeCases/Zero_resource_request (0.00s)
    --- PASS: TestQuotaEnforcer_EdgeCases/Context_cancellation (0.00s)
=== RUN   TestEnforcementMode_Constants
--- PASS: TestEnforcementMode_Constants (0.00s)
=== RUN   TestPreemptionPolicy_Constants
--- PASS: TestPreemptionPolicy_Constants (0.00s)
PASS
coverage: 96.2% of statements
ok  	github.com/ljluestc/orchestrator/pkg/scheduler	0.105s	coverage: 96.2% of statements
